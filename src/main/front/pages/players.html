<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenDiamond - Players</title>
  <link rel="icon" href="/pages/resources/baseball-diamond.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <link href="/css/styles.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha384-o5uz97et3bErHvpKfD4Jz4n0JfhJDWABFuF4NP+iEEDxE1VwMWJ19QGR0lqFZnr6" crossorigin="anonymous"></script>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container-fluid px-4">
      <a class="navbar-brand fw-bold" href="/"><img src="/pages/resources/baseball-diamond.png" alt="Diamond" style="height: 28px; vertical-align: middle; margin-right: 6px;"> OpenDiamond</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">HOME</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/players">PLAYERS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/games">GAMES</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/teams">TEAMS</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="page-content">
    <div class="container">
      <h1 class="mt-4">Player Stats Dashboard</h1>
      <p class="subtitle">Search for a player to view career statistics and trends</p>

      <div class="search-box">
        <input id="userInput" type="text" placeholder="Enter player name (e.g., Hunter Goodman)" />
        <button class="btn-search" id="searchBtn">Search</button>
      </div>
      <div class="loading" id="loading">Loading player data...</div>
      <div class="error-message" id="errorMessage" style="display: none;"></div>

      <div id="playerInfo" class="player-info" style="display: none;">
        <h2 id="playerName"></h2>
        <div id="playerCareerStats" class="player-stats-grid"></div>
      </div>

      <div class="dashboard" id="dashboard" style="display: none;">
        <div class="chart-card">
          <h3>Hits by Season</h3>
          <div id="hitsChart" class="chart-container"></div>
        </div>
        <div class="chart-card">
          <h3>Batting Average by Season</h3>
          <div id="batting-avgChart" class="chart-container"></div>
        </div>
        <div class="chart-card">
          <h3>RBIs by Season</h3>
          <div id="rbisChart" class="chart-container"></div>
        </div>
        <div class="chart-card">
          <h3>Extra Base Hits by Season</h3>
          <div id="xbhChart" class="chart-container"></div>
        </div>
        <div class="chart-card">
          <h3>ERA Over Time</h3>
          <div id="eraChart" class="chart-container"></div>
        </div>
        <div class="chart-card">
          <h3>WHIP Over Time</h3>
          <div id="whipChart" class="chart-container"></div>
        </div>
      </div>

      <div class="stats-table" id="statsTableContainer" style="display: none;">
        <div class="stats-table-inner">
        <h3>Season-by-Season Statistics</h3>
        <table id="statsTable">
          <thead id="statsTableHead">
            <tr>
              <th>Season</th>
              <th>Hits</th>
              <th>Doubles</th>
              <th>Triples</th>
              <th>Home Runs</th>
              <th>RBIs</th>
              <th>Avg</th>
              <th>OBP</th>
              <th>SLG</th>
            </tr>
          </thead>
          <tbody id="statsTableBody">
          </tbody>
        </table>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/charts.js"></script>
  <script src="/js/players.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (typeof initCharts === 'function') initCharts();
      if (typeof initializeResizeListener === 'function') initializeResizeListener();

      const searchBtn = document.getElementById('searchBtn');
      const userInput = document.getElementById('userInput');

      if (searchBtn && typeof send === 'function') searchBtn.addEventListener('click', send);
      if (userInput && typeof send === 'function') {
        userInput.addEventListener('keypress', function(event) {
          if (event.key === 'Enter') send();
        });
      }

      const params = new URLSearchParams(window.location.search);
      const autoSearch = params.get('search');
      if (autoSearch && userInput && typeof send === 'function') {
        userInput.value = autoSearch;
        send();
      }
    });
  </script>

  <footer style="text-align: center; padding: 16px 0; font-size: 0.75rem; color: #999;">
    <a href="https://www.flaticon.com/free-icons/sports-and-competition" title="sports and competition icons" style="color: #999; text-decoration: none;">Sports and competition icons created by bearicons - Flaticon</a>
  </footer>
</body>
</html>
